<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hodimlar Platformasi</title>

<style>
:root {
    --primary-color:#1e40af;
    --secondary-color:#2563eb;
    --bg-light:#f4f6f8;
    --bg-dark:#1e1e2f;
    --text-light:#ffffff;
    --text-dark:#1e1e2f;
    --task-done:#28a745;
    --task-overdue:#dc3545;
    --task-pending:#facc15;
}
body{
    margin:0;
    font-family:'Segoe UI',sans-serif;
    background:var(--bg-light);
    color:var(--text-dark);
}
header{
    background:var(--primary-color);
    color:white;
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:15px 20px;
    position:sticky;
    top:0;
}
.theme-toggle{
    background:none;
    border:none;
    font-size:22px;
    cursor:pointer;
}
.controls,.filters{
    display:flex;
    gap:10px;
    padding:10px 20px;
    flex-wrap:wrap;
}
.controls button{
    padding:6px 12px;
    border:none;
    background:var(--secondary-color);
    color:white;
    border-radius:5px;
    cursor:pointer;
}
.employee-list{
    padding:10px 20px;
    display:flex;
    flex-direction:column;
    gap:15px;
}
.employee{
    background:white;
    border-radius:10px;
    padding:15px;
    box-shadow:0 2px 6px rgba(0,0,0,.1);
}
.employee-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
}
.employee-info span{
    background:#e0e7ff;
    padding:5px 10px;
    border-radius:5px;
    margin-right:10px;
}
.employee-btns button{
    margin-left:5px;
    padding:4px 8px;
    border:none;
    border-radius:5px;
    cursor:pointer;
}
.add-task{background:#2563eb;color:white;}
.remove-employee{background:#dc3545;color:white;}
.show-done{background:#16a34a;color:white;}

.tasks{margin-left:20px;display:flex;flex-direction:column;gap:6px;}
.task{
    background:#f9f9f9;
    padding:8px 10px;
    border-radius:6px;
    display:flex;
    justify-content:space-between;
    border-left:5px solid var(--task-pending);
}
.task.done{background:#d1fae5;border-left-color:var(--task-done);text-decoration:line-through;}
.task.overdue{background:#fca5a5;border-left-color:var(--task-overdue);}
.task button{
    margin-left:5px;
    border:none;
    border-radius:4px;
    padding:3px 6px;
    cursor:pointer;
}
.done-btn{background:#28a745;color:white;}
.edit-btn{background:#fbbf24;color:white;}
.move-btn{background:#3b82f6;color:white;}

body.dark{
    background:var(--bg-dark);
    color:white;
}
body.dark .employee{background:#2b2b3a;}
body.dark .task{background:#3b3b4b;}
</style>
</head>

<body>

<header>
<h1>Hodimlar bo'yicha ma'lumot</h1>
<button class="theme-toggle" onclick="toggleTheme()">üåô / ‚òÄÔ∏è</button>
</header>

<div class="controls">
<button onclick="addEmployee()">Hodim qo‚Äòshish</button>
</div>

<div class="filters">
<select id="employeeFilter" onchange="applyFilter()">
<option value="">Hodimni tanlang</option>
</select>
<select id="taskFilter" onchange="applyFilter()">
<option value="">Vazifani tanlang</option>
</select>
<input type="date" id="startDate" onchange="applyFilter()">
<input type="date" id="endDate" onchange="applyFilter()">
</div>

<div class="employee-list" id="employeeList"></div>

<script>
let employees = [];

/* ===== SAQLASH / YUKLASH ===== */
function saveData(){
    localStorage.setItem("employeesData", JSON.stringify(employees));
}
function loadData(){
    const data = localStorage.getItem("employeesData");
    if(data){
        employees = JSON.parse(data);
    }
    renderEmployees();
}
window.onload = loadData;

/* ===== TEMA ===== */
function toggleTheme(){
    document.body.classList.toggle('dark');
}

/* ===== HODIM ===== */
function addEmployee(){
    const name = prompt("Hodim ismi familiyasi:");
    if(!name) return;
    const location = prompt("Qayerda ishlaydi:");
    const position = prompt("Lavozimi:");
    employees.push({name,location,position,tasks:[],showDone:false});
    saveData();
    renderEmployees();
}

function removeEmployee(i){
    if(confirm("Hodim o‚Äòchirilsinmi?")){
        employees.splice(i,1);
        saveData();
        renderEmployees();
    }
}

/* ===== VAZIFA ===== */
function addTask(i){
    const name = prompt("Vazifa nomi:");
    const deadline = prompt("Muddati (YYYY-MM-DD):");
    const location = prompt("Qayerda bajariladi:");
    if(name && deadline){
        employees[i].tasks.push({name,deadline,location,done:false});
        saveData();
        renderEmployees();
    }
}

function markDone(e,t){
    employees[e].tasks[t].done = true;
    saveData();
    renderEmployees();
}

function editTask(e,t){
    const task = employees[e].tasks[t];
    task.name = prompt("Vazifa nomi:",task.name) || task.name;
    task.deadline = prompt("Muddati:",task.deadline) || task.deadline;
    task.location = prompt("Qayerda:",task.location) || task.location;
    task.done = confirm("Bajarildimi?");
    saveData();
    renderEmployees();
}

function moveTask(e,t){
    const name = prompt("Qaysi hodimga?");
    const i = employees.findIndex(x=>x.name.toLowerCase()==name.toLowerCase());
    if(i>=0){
        employees[i].tasks.push(employees[e].tasks[t]);
        employees[e].tasks.splice(t,1);
        saveData();
        renderEmployees();
    }else alert("Hodim topilmadi!");
}

function toggleDoneTasks(i){
    employees[i].showDone = !employees[i].showDone;
    saveData();
    renderEmployees();
}

/* ===== FILTR ===== */
function applyFilter(){
    renderEmployees(true);
}

/* ===== RENDER ===== */
function renderEmployees(filter=false){
    const list = document.getElementById('employeeList');
    list.innerHTML = "";

    employees.forEach((emp,i)=>{
        const div = document.createElement('div');
        div.className='employee';

        div.innerHTML = `
        <div class="employee-header">
            <b>${emp.name} (${emp.position})</b>
            <div class="employee-btns">
                <button class="add-task" onclick="addTask(${i})">Vazifa</button>
                <button class="remove-employee" onclick="removeEmployee(${i})">O‚Äòchirish</button>
                <button class="show-done" onclick="toggleDoneTasks(${i})">
                    ${emp.showDone?"Yashirish":"Bajarilganlar"}
                </button>
            </div>
        </div>
        <div class="employee-info">
            <span>${emp.location}</span>
        </div>
        `;

        const tasks = document.createElement('div');
        tasks.className='tasks';

        emp.tasks.forEach((t,ti)=>{
            if(!emp.showDone && t.done) return;
            const task = document.createElement('div');
            task.className='task'+(t.done?' done':'')+(new Date(t.deadline)<new Date()&&!t.done?' overdue':'');
            task.innerHTML = `
            <span>${t.name} | ${t.deadline} | ${t.location}</span>
            <span>
                <button class="done-btn" onclick="markDone(${i},${ti})">‚úî</button>
                <button class="edit-btn" onclick="editTask(${i},${ti})">‚úé</button>
                <button class="move-btn" onclick="moveTask(${i},${ti})">‚áÑ</button>
            </span>`;
            tasks.appendChild(task);
        });

        div.appendChild(tasks);
        list.appendChild(div);
    });
}
</script>

</body>
</html>
